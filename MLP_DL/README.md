# Детектор ARP-spoofing атак с использованием нейронных сетей

Данный проект представляет собой систему обнаружения ARP-spoofing атак на основе нейронных сетей. Система использует анализ признаков ARP-пакетов для классификации их как нормальных или аномальных (потенциальная ARP-spoofing атака).

## Обзор проекта

ARP-spoofing - это тип атаки, при котором злоумышленник отправляет поддельные ARP-сообщения в локальной сети с целью связать свой MAC-адрес с IP-адресом легитимного узла или шлюза, что позволяет перехватывать, модифицировать или блокировать сетевой трафик.

Данный проект использует методы машинного обучения для выявления аномального поведения в ARP-трафике, что позволяет обнаруживать атаки ARP-spoofing в реальном времени.

## Функциональность

- Предобработка данных об ARP-пакетах (нормализация, кодирование признаков)
- Обучение нейронной сети для классификации ARP-пакетов
- Анализ сетевого трафика в реальном времени для обнаружения ARP-spoofing атак
- Визуализация результатов обучения и оценки модели

## Структура проекта

```
.
├── Data/                        # Директория с данными
│   ├── combined_features.csv    # Объединенный датасет (нормальные и аномальные пакеты)
│   ├── normal_features.csv      # Датасет с нормальными пакетами
│   └── anomaly_features.csv     # Датасет с аномальными пакетами (ARP-spoofing)
├── models/                      # Директория для сохранения обученных моделей и результатов
├── src/                         # Исходный код проекта
│   ├── preprocessing.py         # Модуль предобработки данных
│   ├── model.py                 # Определение и обучение нейронной сети
│   ├── train.py                 # Скрипт для обучения модели
│   └── detector.py              # Детектор ARP-spoofing атак в реальном времени
└── requirements.txt             # Зависимости проекта
```

## Требования

- Python 3.8+
- TensorFlow 2.x
- Pandas
- NumPy
- Scikit-learn
- Matplotlib
- Scapy

## Установка

1. Клонируйте репозиторий:
   ```
   git clone <url-репозитория>
   cd <директория-проекта>
   ```

2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

## Использование

### Обучение модели

Для обучения модели на имеющихся данных выполните:

```
python src/train.py --data Data/combined_features.csv --model-dir models/ --epochs 100 --batch-size 32
```

Параметры:
- `--data`: путь к файлу данных (CSV)
- `--model-dir`: директория для сохранения модели и результатов
- `--batch-size`: размер батча для обучения
- `--epochs`: максимальное количество эпох обучения
- `--test-size`: доля тестовых данных (по умолчанию 0.2)
- `--val-size`: доля валидационных данных (по умолчанию 0.2)
- `--hidden-layers`: размеры скрытых слоев (по умолчанию 128 64 32)
- `--dropout-rate`: коэффициент прореживания (по умолчанию 0.3)

### Запуск детектора

После обучения модели, вы можете запустить детектор для анализа сетевого трафика в реальном времени:

```
python src/detector.py --model models/arp_spoofing_detector.h5 --scaler models/scaler.pkl --interface <интерфейс>
```

Параметры:
- `--model`: путь к файлу модели
- `--scaler`: путь к файлу скейлера
- `--interface`: сетевой интерфейс для сниффинга (None для всех интерфейсов)
- `--window`: размер окна для отслеживания пакетов (по умолчанию 10)
- `--threshold`: порог для классификации пакета как аномального (по умолчанию 0.7)

## Архитектура нейронной сети

В проекте используется полносвязная нейронная сеть (Multi-Layer Perceptron) со следующими особенностями:

- Несколько скрытых слоев с активацией ReLU
- Батч-нормализация для стабилизации обучения
- Dropout для предотвращения переобучения
- Сигмоидная активация в выходном слое для бинарной классификации

## Признаки для обнаружения ARP-spoofing

Модель использует следующие признаки для классификации ARP-пакетов:
- IP-адреса и MAC-адреса источника и назначения
- Тип ARP-сообщения (запрос или ответ)
- Признак широковещательной передачи
- Количество дубликатов пакетов
- Количество запросов и ответов
- Скорость передачи пакетов
- Признак использования нескольких MAC-адресов для одного IP
- Соотношение запросов и ответов

## Метрики качества

Качество модели оценивается с использованием следующих метрик:
- Accuracy (точность)
- Precision (точность в терминах информационного поиска)
- Recall (полнота)
- F1-score (гармоническое среднее между precision и recall)

## Результаты

После обучения модели, в директории `models/` будут сохранены:
- Обученная модель (`arp_spoofing_detector.h5`)
- Скейлер для нормализации признаков (`scaler.pkl`)
- Метрики качества модели (`metrics.json`)
- График истории обучения (`training_history.png`)
- Матрица ошибок (`confusion_matrix.png`)

## Лицензия

Проект распространяется под лицензией MIT. См. файл LICENSE для получения дополнительной информации.

## Авторы

- [Ваше имя] - [Ваш e-mail]

## Благодарности

- [Благодарности участникам, которые помогли в разработке проекта] 